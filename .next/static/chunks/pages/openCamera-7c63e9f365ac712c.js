(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{79898:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/openCamera",function(){return n(7520)}])},7520:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(85893),s=n(67294),c=n(34051),a=n.n(c),o=(n(41664),n(64970)),i=n.n(o),u=n(98690),l=n.n(u),p=n(57632),f=n(55678),g=(n(64213),n(11163)),h=n(9669),m=n.n(h),d=n(48764).Buffer;function v(e,t,n,r,s,c,a){try{var o=e[c](a),i=o.value}catch(u){return void n(u)}o.done?t(i):Promise.resolve(i).then(r,s)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var c=e.apply(t,n);function a(e){v(c,r,s,a,o,"next",e)}function o(e){v(c,r,s,a,o,"throw",e)}a(void 0)}))}}function x(){var e=(0,s.useRef)(),t=(0,s.useState)(),n=t[0],c=t[1],o=(0,s.useState)(),u=o[0],h=o[1],v=(0,p.Z)(),x=(0,g.useRouter)(),b=[],k=0;console.log("tricepay","to get the bucket");var S="us-east-1",j=(0,s.useCallback)((function(){var t,n=null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.getScreenshot();c(n),localStorage.setItem("imageSrc",n);var r=n.replace(/^data:image\/\w+;base64,/,""),s=d.from(r,"base64");console.log(s),h(s)}),[e]),w=new(l().S3)({accessKeyId:"AKIARMXKSLZISPI2SPPD",secretAccessKey:"74dnKPKdNb6Nf10su8zMgae8Bsn1NvyqsktipZ/r",region:S}),K=new(l().Rekognition)({accessKeyId:"AKIARMXKSLZISPI2SPPD",secretAccessKey:"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",region:S}),I=function(){var e=y(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={Bucket:"tricepay",Key:"".concat(v,".png"),Body:u,collectionId:"p2p",ContentEncoding:"base64",ContentType:"image/png"},console.log(t.Key,"to get the value of params"),w.upload(t,(function(e,t){e?console.log(e):(console.log(t.Location),console.log(t))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){n&&(I(n),localStorage.setItem("tabs",!1),setTimeout((function(){x.push("/tabsLink")}),[1e3]))};function C(){return(C=y(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(null),e.abrupt("return");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return(P=y(a().mark((function e(){var t,n,r,s,c,o,i,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={SourceImage:{Bytes:u},SimilarityThreshold:90},e.next=4,w.listObjectsV2({Bucket:"tricepay"}).promise();case 4:n=e.sent,r=0,s=0;case 7:if(!(s<n.Contents.length)){e.next=36;break}return c=n.Contents[s],o=Object.assign({},t,{TargetImage:{S3Object:{Bucket:"tricepay",Name:c.Key}}}),console.log(c.Key,"to check the content"),localStorage.setItem("contentKey",c.Key),e.next=14,_(o,t,c);case 14:if(k=e.sent,r++,console.log(r,"counter"),console.log(n.Contents.length,"length"),console.log(k,"status"),r===n.Contents.length&&0===k&&(console.log("upload"),N()),1!==k){e.next=32;break}return console.log("api"),e.next=24,m().post("/api/faceImpression",{faceImpression:c.Key});case 24:return i=e.sent,l=i.data,console.log(l,"to get response from api "),localStorage.setItem("tabs",!0),setTimeout((function(){x.push("/tabsLink")}),[1e3]),e.abrupt("break",36);case 32:case 33:s++,e.next=7;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(0),console.log(e.t0);case 41:case"end":return e.stop()}}),e,null,[[0,38]])})))).apply(this,arguments)}function _(e,t,n){return B.apply(this,arguments)}function B(){return(B=y(a().mark((function e(t,n,r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.compareFaces(t).promise();case 3:if(!((s=e.sent).FaceMatches.length>0&&s.FaceMatches[0].Similarity>n.SimilarityThreshold)){e.next=9;break}return console.log("Match found with ".concat(r.Key,". Similarity score: ").concat(s.FaceMatches[0].Similarity)),e.abrupt("return",1);case 9:return console.log("no match found"),e.abrupt("return",0);case 11:e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",-1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}return(0,s.useEffect)((function(){console.log(b,"raw data dljsn")})),(0,r.jsxs)("section",{class:"camera",children:[(0,r.jsx)(f.Ix,{}),(0,r.jsx)("div",{class:"container",children:(0,r.jsxs)("div",{class:"camera-image",children:[n?"":(0,r.jsxs)("div",{className:"cameraFirstPart",children:[(0,r.jsx)(i(),{ref:e,screenshotFormat:"image/jpeg",audio:!1,className:"imageSetting",mirrored:!1}),(0,r.jsx)("div",{className:"captureDiv",children:(0,r.jsx)("button",{className:"btn connect-wallet",onClick:j,type:"submit",children:"Capture"})})]}),n?(0,r.jsxs)("div",{className:"cameraFirstPart",children:[(0,r.jsx)("img",{className:"imageSetting",src:n}),(0,r.jsxs)("div",{className:"captureDiv",id:"captureDivID",children:[(0,r.jsx)("img",{src:"/close.png",onClick:function(){return C.apply(this,arguments)}}),(0,r.jsx)("img",{src:"/siglecheck.png",onClick:function(){return P.apply(this,arguments)}})]})]}):""]})})]})}var b=n(9008),k=n.n(b),S=function(){return(0,r.jsxs)("div",{children:[(0,r.jsx)(k(),{children:(0,r.jsx)("title",{children:"Open Camera"})}),(0,r.jsx)(x,{})]})}},28022:function(){}},function(e){e.O(0,[586,664,764,669,539,77,774,888,179],(function(){return t=79898,e(e.s=t);var t}));var t=e.O();_N_E=t}]);